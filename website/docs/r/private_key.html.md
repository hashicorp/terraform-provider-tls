---
layout: "tls"
page_title: "TLS: tls_private_key"
sidebar_current: "docs-tls-resource-private-key"
description: |-
  Creates a PEM (and OpenSSH) formatted private key.
---

# tls\_private\_key

Generates a secure private key and encodes it as [PEM (RFC 1421)](https://datatracker.ietf.org/doc/html/rfc1421).
This resource is primarily intended for easily bootstrapping throwaway development environments.

~> **Important Security Notice** The private key generated by this resource will
be stored *unencrypted* in your Terraform state file. **Use of this resource
for production deployments is *not* recommended**. Instead, generate
a private key file outside of Terraform and distribute it securely
to the system where Terraform will be run.

This is a *logical resource*, so it contributes only to the current Terraform
state and does not create any external managed resources.

## Example Usage

```hcl
# ECDSA key with P384 elliptic curve
resource "tls_private_key" "ecdsa-p384-example" {
  algorithm   = "ECDSA"
  ecdsa_curve = "P384"
}

# RSA key of size 4096 bits
resource "tls_private_key" "rsa-4096-example" {
  algorithm = "RSA"
  rsa_bits  = 4096
}

# ED25519 key
resource "tls_private_key" "ed25519-example" {
  algorithm = "ED25519"
}
```

## Argument Reference

The following arguments are supported:

* `algorithm` - (Required) The name of the algorithm to use when generating
the key. Currently-supported values are `RSA`, `ECDSA` and `ED25519`.

* `rsa_bits` - (Optional) When `algorithm` is `RSA`, the size of the generated
RSA key in bits. Defaults to `2048`.

* `ecdsa_curve` - (Optional) When `algorithm` is `ECDSA`, the name of the elliptic
curve to use. Currently-supported values are `P224` (default), `P256`, `P384` or `P521`.

### Limitations: `ECDSA` with `P224` elliptic curve 

When using `ECDSA` with `P224`, the following attributes will have a value of `""` (empty string):

* `.public_key_openssh`
* `.private_key_openssh`
* `.public_key_fingerprint_md5`
* `.public_key_fingerprint_sha256`

The SSH ECC Algorithm Integration ([RFC 5656](https://datatracker.ietf.org/doc/html/rfc5656))
restricts support for elliptic curves to "nistp256", "nistp384" and "nistp521",
so these [OpenSSH](https://www.openssh.com/)-specific attributes will be left blank.

## Attributes Reference

The following attributes are exported:

* `algorithm` - The algorithm that was selected for the key.

* `public_key_pem` - The public key data in PEM format.

* `private_key_pem` - The private key data in PEM format.

* `public_key_openssh` - The public key data in [OpenSSH PEM (RFC 4716)](https://datatracker.ietf.org/doc/html/rfc4716)
  format. This is also known as
  ["Authorized Keys"](https://www.ssh.com/academy/ssh/authorized_keys/openssh#format-of-the-authorized-keys-file)
  format. This is populated only if the configured private key is supported:
  this includes all `RSA` and `ED25519` keys, as well as `ECDSA` keys with curves
  `P256`, `P384` and `P521` (see [above](#limitations-ecdsa-with-p224-elliptic-curve)).

* `private_key_openssh` - The private key data in OpenSSH-compatible format.

* `public_key_fingerprint_md5` - The fingerprint of the public key data in
  OpenSSH MD5 hash format, e.g. `aa:bb:cc:...`. Only available if the
  selected private key format is compatible, as per the rules for
  `public_key_openssh` (see [above](#limitations-ecdsa-with-p224-elliptic-curve)).

* `public_key_fingerprint_sha256` - The fingerprint of the public key data in
  OpenSSH SHA256 hash format, e.g. `SHA256:...`. Only available if the
  selected private key format is compatible, as per the rules for
  `public_key_openssh` (see [above](#limitations-ecdsa-with-p224-elliptic-curve)).

## Generating a New Key

Since a private key is a logical resource that lives only in the Terraform state,
it will persist until it is explicitly destroyed by the user.

In order to force the generation of a new key within an existing state, the
private key instance can be "tainted":

```
terraform taint tls_private_key.example
```

A new key will then be generated on the next ``terraform apply``.

## Import

Import is supported for private key files in PEM format using the following syntax:

```shell
terraform import tls_private_key.example key.pem
```
